{% extends 'wish_list/base.html' %}

{% block content %}
    <p>Osoba: {{ user.first_name }} {{ user.last_name }}</p>
    <p>Okazja: {{ wish_list.name }}</p>
    {% if user == request.user %}
    <button type="submit"><a href="/{{ user.id }}/{{ wish_list.id }}/addGift">Dodaj produkt do listy</a></button>
    <button type="submit"><a href="/{{ user.id }}/{{ wish_list.id }}/delete">Usuń listę</a></button>
    {% endif %}
    <table>
        <tbody>
            {% for gift in gifts %}
            <tr>
                <td><img src="/media/{{ gift.file }}"></td>
                <td>{{ gift.name }}<br>{{ gift.desciption }}<br>
                    <button type="submit"><a target="_blank" href="{{ gift.shop }}">Przejdź do sklepu</a></button></td>
                <td>{{ gift.person.first_name|default:"Wolne"}}<br>
                    {% if request.user.is_authenticated %}
                    {% if not gift.person %}
                    <button type="submit"><a href="/take/{{ user.id }}/{{ wish_list.id }}/{{ gift.id }}">Zaklepuję ten prezent</a></button>
                    {% else %}
                    {% if gift.person == request.user %}
                    <button type="submit"><a href="/leave/{{ user.id }}/{{ wish_list.id }}/{{ gift.id }}">Zrezygnuj z kupna tego prezentu</a></button>
                    {% endif %}
                    {% endif %}
                    {% endif %}
                </td>
                {% if user == request.user %}
                <td>
                    <button type="submit"><a href="/{{ user.id }}/{{ wish_list.id }}/{{ gift.id }}">Edytuj</a></button><br>
                    <button type="submit"><a href="/{{ user.id }}/{{ wish_list.id }}/{{ gift.id }}/delete">Usuń</a></button></td>
                {% endif %}
            </tr>
            {% endfor %}
        </tbody>
    </table>

{% endblock %}